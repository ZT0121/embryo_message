<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <link rel="icon" type="image/png" href="favicon.png" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å ±èƒšè¨Šæ¯ç”¢ç”Ÿå™¨</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      font-size: 13px;
      background-color: #fdfaf7;
      color: #4b3b30;
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
    }
    pre {
      white-space: pre-wrap;
      line-height: 1.8;
    }
    h1 {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.3rem;
      margin-top: 0.3rem;
      border-radius: 0.4rem;
      border: 1px solid #ccc;
      font-size: 13px;
    }
    button {
      margin-top: 1rem;
      background-color: #d8c3a5;
      border: none;
      padding: 0.4rem 1rem;
      border-radius: 0.5rem;
      font-size: 11px;
      line-height: 1.6;
      cursor: pointer;
      margin-right: 0.5rem;
    }
    #output {
      margin-top: 2rem;
      padding: 1rem;
      background: #fff;
      border: 1px solid #e0d6cd;
      border-radius: 1rem;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>ğŸ“œå ±èƒšè¨Šæ¯ç”¢ç”Ÿå™¨</h1>
  <label for="type">ğŸ§«å›å ±é¡å‹</label>
  <select id="type">
    <option>1ï¸âƒ£D1ï¼ˆD5~D7 å†·å‡ï¼‰</option>
    <option>1ï¸âƒ£D1ï¼ˆD5~D7 åˆ‡ç‰‡ï¼‹å†·å‡ï¼‰</option>
    <option>1ï¸âƒ£D1ï¼ˆD5 æ¤å…¥ï¼‰</option>
    <option>3ï¸âƒ£D3 å†·å‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰</option>
    <option>5ï¸âƒ£D5 å†·å‡ï¼ˆæœ‰è§€å¯Ÿä¸­ï¼‰</option>
    <option>5ï¸âƒ£D5 å†·å‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰</option>
    <option>5ï¸âƒ£D5 åˆ‡ç‰‡ï¼‹å†·å‡ï¼ˆæœ‰è§€å¯Ÿä¸­ï¼‰</option>
    <option>5ï¸âƒ£D5 åˆ‡ç‰‡ï¼‹å†·å‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰</option>
    <option>5ï¸âƒ£D5 å†·å‡å«éƒ¨åˆ†åˆ‡ç‰‡ï¼ˆæœ‰è§€å¯Ÿä¸­ï¼‰</option>
    <option>5ï¸âƒ£D5 å†·å‡å«éƒ¨åˆ†åˆ‡ç‰‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰</option>
  </select>
  <label for="name">ğŸ†”å§“å</label>
  <input type="text" id="name" />
  <label for="date">ğŸ“†ä»Šæ—¥æ—¥æœŸ</label>
  <input type="date" id="date" />
  <label for="stage">ğŸ“ä»Šå¤©æ˜¯</label>
  <select id="stage">
    <option value="1">1ï¸âƒ£D1</option>
    <option value="3">3ï¸âƒ£D3</option>
    <option value="5" selected>5ï¸âƒ£D5</option>
    <option value="6">6ï¸âƒ£D6</option>
    <option value="7">7ï¸âƒ£D7</option>
  </select>
  <label for="num1">â˜ƒï¸æˆåŠŸå—ç²¾é¡†æ•¸ æˆ– å†·å‡é¡†æ•¸ï¼ˆä¾é¡å‹è€Œå®šï¼‰</label>
  <input type="number" id="num1" />
  <label for="num2">ğŸ§¬åˆ‡ç‰‡é¡†æ•¸ï¼ˆåƒ…å†·å‡å«éƒ¨åˆ†åˆ‡ç‰‡ç”¨ï¼‰</label>
  <input type="number" id="num2" />
  <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
    <button onclick="generateMessage()">âš™ï¸ç”¢ç”Ÿè¨Šæ¯</button>
    <button onclick="copyOutput()">âœ…è¤‡è£½è¨Šæ¯</button>
  </div>
  <div id="output"></div>
  <textarea id="hiddenCopy" style="position:absolute; left:-9999px;"></textarea>
  <div id="history" style="margin-top:2rem; background-color: #f5eee6; padding: 1rem; border-radius: 1rem; border: 1px solid #e0d6cd;">
    <h2 style="font-size: 1.25rem; margin-bottom: 1rem; text-align: center;">æ­·å²ç´€éŒ„</h2>
    <ul id="historyList" style="list-style:none; padding-left:0; display: flex; flex-direction: column-reverse; gap: 1rem;"></ul>
    <button onclick="clearHistory()" style="margin-top: 1rem; background-color: #e4d1bd; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer; width: 100%;">æ¸…é™¤æ­·å²ç´€éŒ„</button>
  </div>
  <script>
    window.addEventListener('load', () => {
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      const dateInput = document.getElementById('date');
      if (dateInput && !dateInput.value) {
        dateInput.value = `${yyyy}-${mm}-${dd}`;
      }
      loadHistory();
    });

    function generateMessage() {
      const type = document.getElementById('type').value;
      const name = document.getElementById('name').value.trim();
      const date = document.getElementById('date').value;
      const num1 = document.getElementById('num1').value;
      const num2 = document.getElementById('num2').value;
      const stage = document.getElementById('stage').value;

      const formatDatePlus = (base, days) => {
        const d = new Date(base);
        d.setDate(d.getDate() + days);
        return `${(d.getMonth() + 1).toString().padStart(2, '0')}/${d.getDate().toString().padStart(2, '0')}`;
      };

      const queryDateByStage = () => {
      const d = new Date(date);
      const stageDay = parseInt(stage);
      const daysToD8 = 8 - stageDay;
      d.setDate(d.getDate() + daysToD8);
      return `${(d.getMonth() + 1).toString().padStart(2, '0')}/${d.getDate().toString().padStart(2, '0')}`;
      };


      let message = '';

      if (type === '1ï¸âƒ£D1ï¼ˆD5~D7 å†·å‡ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œ\né€šçŸ¥æ‚¨é€™æ¬¡ç™‚ç¨‹ä¸€å…±æœ‰ ${num1} é¡†åµå­æˆåŠŸå—ç²¾å›‰ï¼\nèƒšèƒç™¼è‚²æ˜¯ä¸€å€‹å‹•æ…‹è‡ªæˆ‘ç¯©é¸çš„éç¨‹ï¼Œæˆ‘å€‘æœƒæŒçºŒå‘µè­·èƒšèƒå¯¶å¯¶å€‘ã€‚\næˆ‘å€‘é è¨ˆåœ¨ ${formatDatePlus(date, 4)}~${formatDatePlus(date, 6)} ä¹‹é–“å¹«èƒšèƒé€²è¡Œå†·å‡ï¼Œ\næœ€å¾Œçš„å†·å‡é¡†æ•¸ã€èƒšèƒçš„ç­‰ç´šå’Œç…§ç‰‡æ‚¨å¯æ–¼ ${formatDatePlus(date, 7)} 17:00å¾Œï¼Œåœ¨APPä¸ŠæŸ»è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '1ï¸âƒ£D1ï¼ˆD5~D7 åˆ‡ç‰‡ï¼‹å†·å‡ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œ\né€šçŸ¥æ‚¨é€™æ¬¡ç™‚ç¨‹ä¸€å…±æœ‰ ${num1} é¡†åµå­æˆåŠŸå—ç²¾å›‰ï¼\nèƒšèƒç™¼è‚²æ˜¯ä¸€å€‹å‹•æ…‹è‡ªæˆ‘ç¯©é¸çš„éç¨‹ï¼Œæˆ‘å€‘æœƒæŒçºŒå‘µè­·èƒšèƒå¯¶å¯¶å€‘ã€‚\næˆ‘å€‘é è¨ˆåœ¨ ${formatDatePlus(date, 4)}~${formatDatePlus(date, 6)} ä¹‹é–“å¹«èƒšèƒé€²è¡Œåˆ‡ç‰‡åŠå†·å‡ï¼Œ\næœ€å¾Œçš„å†·å‡é¡†æ•¸ã€èƒšèƒçš„ç­‰ç´šå’Œç…§ç‰‡æ‚¨å¯æ–¼ ${formatDatePlus(date, 7)} 17:00å¾Œï¼Œåœ¨APPä¸ŠæŸ»è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '1ï¸âƒ£D1ï¼ˆD5 æ¤å…¥ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œ\né€šçŸ¥æ‚¨ï¼Œé€™æ¬¡ç™‚ç¨‹å…±æœ‰ ${num1} é¡†åµå­æˆåŠŸå—ç²¾å›‰ï¼\nèƒšèƒçš„ç™¼è‚²æ˜¯ä¸€å€‹è‡ªç„¶ç¯©é¸çš„éç¨‹ï¼Œæˆ‘å€‘æœƒç´°å¿ƒå‘µè­·æ¯ä¸€é¡†çè²´çš„èƒšèƒå¯¶å¯¶ã€‚\næˆ‘å€‘é è¨ˆåœ¨ ${formatDatePlus(date, 4)} é€²è¡Œèƒšèƒæ¤å…¥ï¼Œè«‹æ‚¨ä¿æŒè¼•é¬†æ„‰å¿«çš„å¿ƒæƒ…ï¼Œå¦‚æœ‰ä»»ä½•å•é¡Œï¼Œæ­¡è¿èˆ‡æˆ‘å€‘è¯ç¹«ã€‚\nç¥æ‚¨ä¸€åˆ‡é †åˆ©ï¼`;
      } else if (type === '3ï¸âƒ£D3 å†·å‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ 3 å¤©ï¼Œå¯¦é©—å®¤å’Œæ‚¨æ›´æ–°èƒšèƒçš„ç‹€æ³ï¼š\næœ¬æ¬¡ç™‚ç¨‹æœ‰å¹«æ‚¨å†·å‡ ${num1} é¡†èƒšèƒï¼Œ\nè©³ç´°çš„å†·å‡èƒšèƒçš„ç­‰ç´šå’Œç…§ç‰‡æ‚¨å¯æ–¼ ${formatDatePlus(date, 1)} 17:00 å¾Œï¼Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '5ï¸âƒ£D5 å†·å‡ï¼ˆæœ‰è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ ${stage} å¤©ï¼Œå’Œæ‚¨æ›´æ–°ç›®å‰çš„ç‹€æ³ï¼š\næˆ‘å€‘ä»Šå¤©å·²ç¶“ç‚ºæ‚¨å†·å‡ ${num1} é¡†èƒšèƒå¯¶å¯¶ã€‚\nå¦å¤–ï¼Œé‚„æœ‰èƒšèƒä»åœ¨åŸ¹é¤Šèˆ‡è§€å¯Ÿä¸­ï¼Œå› æ­¤æœ€çµ‚çš„å†·å‡é¡†æ•¸ã€èƒšèƒç­‰ç´šåŠç…§ç‰‡ï¼Œæ‚¨å¯æ–¼ ${queryDateByStage()} 17:00 å¾Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '5ï¸âƒ£D5 å†·å‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ ${stage} å¤©ï¼Œå’Œæ‚¨æ›´æ–°ç›®å‰çš„ç‹€æ³ï¼š\næˆ‘å€‘ä»Šå¤©å·²ç¶“ç‚ºæ‚¨å†·å‡ ${num1} é¡†èƒšèƒå¯¶å¯¶ï¼Œ\nå†·å‡èƒšèƒçš„ç­‰ç´šåŠç…§ç‰‡ï¼Œæ‚¨å¯æ–¼ ${formatDatePlus(date, 3)} 17:00 å¾Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '5ï¸âƒ£D5 åˆ‡ç‰‡ï¼‹å†·å‡ï¼ˆæœ‰è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ ${stage} å¤©ï¼Œå’Œæ‚¨æ›´æ–°ç›®å‰çš„ç‹€æ³ï¼š\næˆ‘å€‘ä»Šå¤©å·²ç¶“ç‚ºæ‚¨åˆ‡ç‰‡åŠå†·å‡ ${num1} é¡†èƒšèƒå¯¶å¯¶ã€‚\næé†’æ‚¨ï¼Œç”±æ–¼é‚„æœ‰èƒšèƒä»åœ¨åŸ¹é¤Šèˆ‡è§€å¯Ÿä¸­ï¼Œå› æ­¤æœ€çµ‚çš„å†·å‡é¡†æ•¸ã€èƒšèƒç­‰ç´šåŠç…§ç‰‡ï¼Œæ‚¨å¯æ–¼ ${queryDateByStage()} 17:00 å¾Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '5ï¸âƒ£D5 åˆ‡ç‰‡ï¼‹å†·å‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ ${stage} å¤©ï¼Œå’Œæ‚¨æ›´æ–°ç›®å‰çš„ç‹€æ³ï¼š\næˆ‘å€‘å·²ç¶“ç‚ºæ‚¨åˆ‡ç‰‡åŠå†·å‡ ${num1} é¡†èƒšèƒå¯¶å¯¶ã€‚\nå†·å‡èƒšèƒçš„ç­‰ç´šåŠç…§ç‰‡ï¼Œæ‚¨å¯æ–¼ ${formatDatePlus(date, 3)} 17:00 å¾Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œè¬è¬æ‚¨ã€‚`;
      } else if (type === '5ï¸âƒ£D5 å†·å‡å«éƒ¨åˆ†åˆ‡ç‰‡ï¼ˆæœ‰è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ ${stage} å¤©ï¼Œå¯¦é©—å®¤å’Œæ‚¨æ›´æ–°èƒšèƒçš„ç‹€æ³ï¼š\nä»Šæ—¥æœ‰å¹«æ‚¨å†·å‡ ${num1} é¡†ï¼Œå…¶ä¸­åˆ‡ç‰‡çš„èƒšèƒå¯¶å¯¶æœ‰ ${num2} é¡†ï¼Œ\næé†’æ‚¨ï¼Œç”±æ–¼å°šæœ‰èƒšèƒä»åœ¨åŸ¹é¤Šè§€å¯Ÿä¸­ï¼Œå› æ­¤æœ€å¾Œçš„å†·å‡é¡†æ•¸ã€èƒšèƒçš„ç­‰ç´šå’Œç…§ç‰‡æ‚¨å¯æ–¼ ${queryDateByStage()} 17:00 å¾Œï¼Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œ è¬è¬æ‚¨ã€‚`;
      } else if (type === '5ï¸âƒ£D5 å†·å‡å«éƒ¨åˆ†åˆ‡ç‰‡ï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰') {
        message = `${name}æ‚¨å¥½ï¼Œä»Šå¤©æ˜¯èƒšèƒåŸ¹é¤Šçš„ç¬¬ ${stage} å¤©ï¼Œå¯¦é©—å®¤å’Œæ‚¨æ›´æ–°èƒšèƒçš„ç‹€æ³ï¼š\né€šçŸ¥æ‚¨æ­¤æ¬¡ç™‚ç¨‹æœ‰å¹«æ‚¨å†·å‡ ${num1} é¡†ï¼Œå…¶ä¸­æœ‰ ${num2} é¡†èƒšèƒæ˜¯æœ‰åˆ‡ç‰‡çš„ï¼Œ\nè©³ç´°å†·å‡èƒšèƒçš„ç­‰ç´šå’Œç…§ç‰‡æ‚¨å¯æ–¼ ${formatDatePlus(date, 3)} 17:00 å¾Œï¼Œåœ¨APPä¸ŠæŸ¥è©¢ï¼Œ è¬è¬æ‚¨ã€‚`;
      } else {
        message = 'ï¼ˆé€™è£¡æœƒé¡¯ç¤ºç”¢ç”Ÿçš„è¨Šæ¯ï¼‰';
      }

      document.getElementById('output').textContent = message;
      addToHistory(message);
    }

    function copyOutput() {
      const text = document.getElementById('output').textContent;
      const hidden = document.getElementById('hiddenCopy');
      hidden.value = text;
      hidden.select();
      document.execCommand("copy");
      hidden.blur();
      alert('è¨Šæ¯å…§å®¹å·²è¤‡è£½ï¼Œå¯ä»¥åˆ°å®˜æ–¹Lineä½¿ç”¨å˜');
    }

    function clearHistory() {
      document.getElementById('historyList').innerHTML = '';
      localStorage.removeItem('messageHistory');
    }

    function addToHistory(msg) {
      const historyList = document.getElementById('historyList');
      const li = document.createElement('li');
      li.style.border = '1px solid #ccc';
      li.style.padding = '0.5rem';
      li.style.marginTop = '0.5rem';
      li.style.borderRadius = '0.5rem';
      li.style.backgroundColor = '#fff8f0';
      li.style.boxShadow = '0 2px 6px rgba(0,0,0,0.05)';

      const pre = document.createElement('pre');
      pre.innerText = msg;

      const copyBtn = document.createElement('button');
      copyBtn.textContent = 'è¤‡è£½';
      copyBtn.style.marginTop = '0.5rem';
      copyBtn.style.backgroundColor = '#d8c3a5';
      copyBtn.style.border = 'none';
      copyBtn.style.padding = '0.3rem 0.8rem';
      copyBtn.style.borderRadius = '0.4rem';
      copyBtn.style.cursor = 'pointer';
      copyBtn.onclick = () => {
        const hidden = document.getElementById('hiddenCopy');
        hidden.value = msg;
        hidden.select();
        document.execCommand("copy");
        hidden.blur();
        alert("å·²è¤‡è£½ï¼");
      };

      li.appendChild(pre);
      li.appendChild(copyBtn);
      historyList.prepend(li);

      saveHistory();
    }

    function saveHistory() {
      const items = [...document.querySelectorAll('#historyList pre')].map(pre => pre.textContent);
      localStorage.setItem('messageHistory', JSON.stringify(items));
    }

    function loadHistory() {
      const data = localStorage.getItem('messageHistory');
      if (data) {
        const messages = JSON.parse(data);
        messages.reverse().forEach(addToHistory);
      }
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <link rel="icon" type="image/png" href="favicon.png" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å ±èƒšè¨Šæ¯</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#fdfaf7">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="MessageHub">
  <link rel="apple-touch-icon" href="icon-512.png">

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js');
      });
    }
  </script>
  
  <style>
    /* å…¨åŸŸè¨­å®š */
    body {
      font-family: "Noto Sans TC", system-ui, -apple-system, sans-serif;
      font-size: 13px;
      background-color: #fdfaf7; /* æº«æš–çš„ç±³è‰²èƒŒæ™¯ */
      color: #4b3b30;
      margin: 0 auto;
      max-width: 600px;
      padding: 1.5rem 1rem;
      line-height: 1.5;
    }

    h1 {
      text-align: center;
      margin-bottom: 1rem;
      color: #5e473a;
      font-weight: 800;
      font-size: 1.5rem;
    }

    /* å°èˆªå€å¡Š - çµ±ä¸€åœ“æ½¤é¢¨æ ¼ */
    .nav {
      text-align: center;
      margin-bottom: 1.5rem;
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    
    .nav-btn {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      background-color: #fcefe6; /* æ·ºç±³è‰² */
      color: #8c6b5d;
      border-radius: 20px; /* åœ“æ½¤é‚Šè§’ */
      text-decoration: none;
      font-weight: bold;
      font-size: 13px;
      transition: all 0.3s ease;
      border: 1px solid transparent;
    }
    
    .nav-btn:hover {
      background-color: #f3d7c3;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    /* è¡¨å–®å…ƒä»¶ */
    label {
      display: block;
      margin-top: 1rem;
      margin-bottom: 0.3rem;
      font-weight: 700;
      color: #6d5648;
      font-size: 13px;
    }

    input, select {
      width: 100%;
      padding: 0.5rem 0.6rem;
      border-radius: 0.4rem;
      border: 1px solid #eee5dd;
      font-size: 13px;
      background-color: #fff;
      transition: all 0.2s;
      box-sizing: border-box;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #d8c3a5;
      box-shadow: 0 0 0 3px rgba(216, 195, 165, 0.3);
    }

    /* æŒ‰éˆ•æ¨£å¼ */
    .btn-group {
      display: flex;
      gap: 0.8rem;
      margin-top: 1.2rem;
    }

    button {
      flex: 1;
      background-color: #d8c3a5;
      color: #4b3b30;
      border: none;
      padding: 0.6rem 1rem;
      border-radius: 0.4rem;
      font-size: 13px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      background-color: #cbb08e;
      transform: translateY(-1px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    /* è¼¸å‡ºå€å¡Š */
    #output {
      margin-top: 1.5rem;
      padding: 1rem;
      background: #fff;
      border: 1px solid #e0d6cd;
      border-radius: 0.6rem;
      white-space: pre-wrap;
      font-size: 13px;
      color: #333;
    }

    /* æ­·å²ç´€éŒ„å€å¡Š */
    #history {
      margin-top: 2rem;
      background-color: #f5eee6;
      padding: 1rem;
      border-radius: 0.6rem;
      border: 1px solid #e0d6cd;
    }
    
    .history-message {
      white-space: pre-wrap;
      word-break: break-word;
      line-height: 1.6;
      font-size: 13px;
      color: #555;
    }

    #historyList {
      list-style: none;
      padding-left: 0;
      display: flex;
      flex-direction: column-reverse;
      gap: 0.8rem;
    }

    #historyList li {
      border: 1px solid #ddd;
      padding: 0.8rem;
      border-radius: 0.4rem;
      background-color: #fff8f0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.02);
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .hidden {
      display: none !important;
    }

    /* æ­·å²å€å¡Šï¼šæ¨™é¡Œå­—é«”å”èª¿ */
.history-title {
  font-size: 0.95rem;
  font-weight: 600;
  letter-spacing: 0.5px;
  color: #6d5648;
  text-align: center;
  margin: 0.2rem 0 0.6rem;
}

/* æ­·å²å€å¡Šï¼šè¤‡è£½æŒ‰éˆ•è®Šæˆè† å›Š tag */
.history-copy-btn {
  align-self: flex-end;
  font-size: 12px;
  font-weight: 600;
  padding: 0.35rem 0.8rem;
  border-radius: 999px;
  background-color: #e8d9c6;
  color: #5e473a;
  border: none;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

.history-copy-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 5px rgba(0,0,0,0.08);
}

  </style>
</head>
<body>

  <h1>ğŸ“œ å ±èƒšè¨Šæ¯</h1>
  
  <div class="nav">
    <a href="rescueICSI.html" class="nav-btn">ğŸ§¬ è£œæ•‘å—ç²¾å›å ±</a>
    <a href="sperm.html" class="nav-btn">ğŸ§ª å‡ç²¾è¨Šæ¯ç”¢ç”Ÿå™¨</a>
    <a href="transfer_message.html" class="nav-btn">ğŸ“¦ è½‰å…¥ï½œè¼¸å‡º å›å ±è¨Šæ¯ç”¢ç”Ÿå™¨</a>
  </div>

  <label for="stage">ğŸ“ ä»Šå¤©æ˜¯</label>
  <select id="stage">
    <option value="1">1ï¸âƒ£ D1</option>
    <option value="3">3ï¸âƒ£ D3</option>
    <option value="5" selected>5ï¸âƒ£ D5</option>
    <option value="6">6ï¸âƒ£ D6</option>
    <option value="7">7ï¸âƒ£ D7</option>
  </select>

  <!-- ä¸»æµç¨‹ï¼šä¸å†é¸ã€Œæƒ…å¢ƒã€ï¼Œæ”¹æˆç”¨æ¬„ä½è‡ªå‹•åˆ¤æ–·æ¨¡æ¿ -->
  <label for="status">ğŸ£ èƒšèƒç‹€æ…‹</label>
  <select id="status">
    <option value="done" selected>âœ… å·²å®Œæˆï¼ˆç„¡è§€å¯Ÿä¸­ï¼‰</option>
    <option value="observing">ğŸ£ å°šæœ‰èƒšèƒä»åœ¨è§€å¯Ÿä¸­</option>
    <option value="all_observing">ğŸ§« å…¨éƒ¨ä»åœ¨è§€å¯Ÿä¸­ï¼ˆä»Šå¤© 0 é¡†å¯å†·å‡/åˆ‡ç‰‡ï¼‰</option>
  </select>

  <!-- åªåœ¨ã€Œå…¨éƒ¨ä»åœ¨è§€å¯Ÿä¸­ã€æ™‚éœ€è¦ï¼šå› ç‚º num1=0 ç„¡æ³•åˆ¤æ–·æ˜¯èµ° å†·å‡ç‰ˆ or åˆ‡ç‰‡ç‰ˆ -->
  <div id="planWhenAllObservingGroup" class="hidden">
    <label for="planWhenAllObserving">ğŸ“Œ æœ¬æ¬¡è¦åŠƒï¼ˆç”¨ä¾†æ±ºå®šæ–‡å­—ç‰ˆæœ¬ï¼‰</label>
    <select id="planWhenAllObserving">
      <option value="freeze" selected>å†·å‡</option>
      <option value="biopsy_freeze">åˆ‡ç‰‡ï¼‹å†·å‡</option>
    </select>
  </div>

  <!-- ç‰¹æ®Šæƒ…å¢ƒï¼šD3 æ¤å…¥ + D5 å›å ±ï¼ˆç„¡èƒšå¯å‡/å¯åˆ‡ï¼‰ -->
  <div id="specialGroup" style="margin-top: 0.6rem;">
    <label for="specialMode">â­ ç‰¹æ®Šæƒ…å¢ƒï¼ˆå¶çˆ¾æ‰ç”¨ï¼‰</label>
    <select id="specialMode">
      <option value="none" selected>ï¼ˆç„¡ï¼‰</option>
      <option value="d3_transfer_d5_no_freeze">3ï¸âƒ£D3æ¤å…¥ + D5 å†·å‡ï¼ˆç„¡èƒšå¯å‡ï¼‰</option>
      <option value="d3_transfer_d5_no_biopsy">3ï¸âƒ£D3æ¤å…¥ + D5 åˆ‡ç‰‡ + å†·å‡ï¼ˆç„¡èƒšå¯åˆ‡ï¼‰</option>
    </select>
  </div>

  <!-- é€²éšï¼šä¿ç•™ D1ï¼ˆç›®å‰ä¸å¸¸ç”¨ï¼Œä½†ä¸åˆªï¼‰ -->
  <div id="advancedD1" style="margin-top: 1rem;">
    <button id="toggleD1Btn" type="button" style="width:100%; background-color:#f3e6da;">
      ğŸ§©ï¼ˆé€²éšï¼‰D1 å—ç²¾å›å ±ï¼ˆä¸å¸¸ç”¨ï¼‰
    </button>
    <div id="d1Content" class="hidden">
      <label for="d1Type">ğŸ§« D1 å›å ±é¡å‹</label>
      <select id="d1Type">
        <option>1ï¸âƒ£D1ï¼ˆD5~D7 å†·å‡ï¼‰</option>
        <option>1ï¸âƒ£D1ï¼ˆD5~D7 åˆ‡ç‰‡ï¼‹å†·å‡ï¼‰</option>
        <option>1ï¸âƒ£D1ï¼ˆD5 æ¤å…¥ï¼‰</option>
      </select>
    </div>
  </div>

  <label for="name">ğŸ†” å§“å</label>
  <input type="text" id="name" placeholder="è«‹è¼¸å…¥å§“å" />
  
  <label for="date">ğŸ“† ä»Šæ—¥æ—¥æœŸ</label>
  <input type="date" id="date" />
  
  <!-- ğŸ“ä»Šå¤©æ˜¯ moved to top -->
  
  <label for="num1">â˜ƒï¸ å†·å‡é¡†æ•¸ï¼ˆæˆ– D3 æ¤å…¥é¡†æ•¸ / D1 å—ç²¾é¡†æ•¸ï¼‰</label>
  <input type="number" id="num1" min="0" placeholder="0" />
  
  <div id="biopsyFieldGroup">
      <label for="num2">ğŸ§¬ åˆ‡ç‰‡é¡†æ•¸ï¼ˆæ²’æœ‰å°±å¡« 0ï¼‰</label>
      <input type="number" id="num2" min="0" placeholder="0" />
  </div>

  <div class="btn-group">
    <button onclick="generateMessage()">âš™ï¸ ç”¢ç”Ÿè¨Šæ¯</button>
    <button onclick="copyOutput()" style="background-color: #a5d8b9; color: #2d4b38;">âœ… è¤‡è£½è¨Šæ¯</button>
  </div>

  <div id="output"></div>
  <textarea id="hiddenCopy" style="position:absolute; left:-9999px;"></textarea>

  <div id="versionInfo"
       style="font-size: 12px; color:#8c6b5d; text-align:center; margin-bottom:0.3rem;">
   </div>
  
  <div id="history">
      <button id="toggleHistoryBtn"
            style="width:100%; margin-bottom:0.6rem; background-color:#f3e6da;">
        ğŸ“‚ é¡¯ç¤ºæ­·å²ç´€éŒ„
      </button>

      <div id="historyContent" class="hidden"> 
      <h2 class="history-title">â³ æ­·å²ç´€éŒ„</h2>


      <ul id="historyList"></ul>
      <button onclick="clearHistory()" style="margin-top: 0.8rem; background-color: #e4d1bd; width: 100%;">
        æ¸…é™¤æ­·å²ç´€éŒ„
      </button>
  </div>
</div>

<script src="js/ui_common_v4.js?v=4.0.1" defer></script>
<script src="js/templates_v4.js?v=4.0.1" defer></script>
<script src="js/app_v4.js?v=4.0.1" defer></script>


  
</body>
</html>

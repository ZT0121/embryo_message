<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <link rel="icon" type="image/png" href="sperm.png" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å‡ç²¾è¨Šæ¯ç”¢ç”Ÿå™¨</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      font-size: 13px;
      background-color: #fdfaf7;
      color: #4b3b30;
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
    }
    h1 {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.3rem;
      margin-top: 0.3rem;
      border-radius: 0.4rem;
      border: 1px solid #ccc;
      font-size: 13px;
    }
    button {
      margin-top: 1rem;
      background-color: #d8c3a5;
      border: none;
      padding: 0.4rem 1rem;
      border-radius: 0.5rem;
      font-size: 11px;
      line-height: 1.6;
      cursor: pointer;
      margin-right: 0.5rem;
      color: #fff;
    }
    #output {
      margin-top: 2rem;
      padding: 1rem;
      background: #fff;
      border: 1px solid #e0d6cd;
      border-radius: 1rem;
      white-space: pre-wrap;
    }
    .scenario-block {
      display: none;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>ğŸ§ªå‡ç²¾è¨Šæ¯ç”¢ç”Ÿå™¨</h1>
  <div class="nav" style="text-align: center; margin-bottom: 1.5rem;">
    <a href="index.html"
       style="display: inline-block; padding: 10px 16px; background-color: #f3d7c3; color: #5e473a; border-radius: 10px; text-decoration: none; font-weight: bold; font-size: 0.95em; transition: background-color 0.3s;"
       onmouseover="this.style.backgroundColor='#e5c0a8'"
       onmouseout="this.style.backgroundColor='#f3d7c3'">ğŸ“œ å ±èƒšè¨Šæ¯</a>

    <a href="rescueICSI.html"
       style="display: inline-block; padding: 10px 16px; background-color: #f3d7c3; color: #5e473a; border-radius: 10px; text-decoration: none; font-weight: bold; font-size: 0.95em; transition: background-color 0.3s; margin-left:0.5rem;"
       onmouseover="this.style.backgroundColor='#e5c0a8'"
       onmouseout="this.style.backgroundColor='#f3d7c3'">ğŸ§¬ è£œæ•‘å—ç²¾å›å ±</a>

    <a href="sperm.html"
       style="display: inline-block; padding: 10px 16px; background-color: #d8c3a5; color: #fff; border-radius: 10px; text-decoration: none; font-weight: bold; font-size: 0.95em; margin-left:0.5rem;">ğŸ§ª å‡ç²¾è¨Šæ¯ç”¢ç”Ÿå™¨</a>
  </div>

  <label for="scenario">é¸æ“‡ç‹€æ³ï¼š</label>
  <select id="scenario" onchange="switchScenario()">
    <option value="">---è«‹é¸æ“‡---</option>
    <option value="s1">å€‹æ¡ˆä¸åœ¨ç¾å ´ç­‰å€™</option>
    <option value="s2b">å€‹æ¡ˆåœ¨ç¾å ´ï¼ŒäºŒå–ä»ä¸ä½³</option>
  </select>

  <label>ç—…æ­·è™Ÿï¼š</label>
  <input type="text" id="caseId" placeholder="12345">

  <label>å§“åï¼š</label>
  <input type="text" id="caseName" placeholder="è‘‰å¤§é›„">

  <label for="doctor">ğŸ©ºé¸æ“‡é†«å¸«ï¼š</label>
  <select id="doctor">
    <option value="">---è«‹é¸æ“‡---</option>
    <option value="é™³é†«å¸«">é™³é†«å¸«</option>
    <option value="å»–é™¢">å»–é™¢</option>
    <option value="è©¹é†«å¸«">è©¹é†«å¸«</option>
    <option value="æ²ˆé†«å¸«">æ²ˆé†«å¸«</option>
    <option value="å¼µé†«å¸«">å¼µé†«å¸«</option>
    <option value="åŠ‰é†«å¸«">åŠ‰é†«å¸«</option>
    <option value="æœ±é™¢">æœ±é™¢</option>
    <option value="ç‹é™¢">ç‹é™¢</option>
    <option value="æ—é†«å¸«">æ—é†«å¸«</option>
    <option value="æé†«å¸«">æé†«å¸«</option>
    <option value="ä½•é†«å¸«">ä½•é†«å¸«</option>
    <option value="æ´ªé†«å¸«">æ´ªé†«å¸«</option>
    <option value="è‡ªå¡«">å…¶ä»–ï¼ˆè‡ªå¡«ï¼‰</option>
  </select>
  <input type="text" id="doctorCustom" placeholder="è¼¸å…¥é†«å¸«å§“å" style="display:none;">

  <!-- æƒ…å¢ƒ 1 -->
  <div id="scenario1" class="scenario-block">
    <h3>æª¢é«”æ•¸æ“š</h3>
    <label>Volume (ml)ï¼š<input type="number" id="volume1" step="0.1"></label>
    <label>Concentration (M)ï¼š<input type="number" id="conc1"></label>
    <label>PR (%)ï¼š<input type="number" id="PR1"></label>
    <label>å†·å‡ç®¡æ•¸ï¼š<input type="number" id="tubes1"></label>

    <button onclick="generateDoctor1()">ğŸ©ºç”¢ç”Ÿé†«å¸«è¨Šæ¯</button>
    <button onclick="generatePatient1()">ğŸ‘¤ç”¢ç”Ÿå€‹æ¡ˆè¨Šæ¯</button>
  </div>

  <!-- æƒ…å¢ƒ 2B -->
  <div id="scenario2b" class="scenario-block">
    <h3>ç¬¬ä¸€æ¬¡æª¢é«”</h3>
    <label>Volume (ml)ï¼š<input type="number" id="volume21" step="0.1"></label>
    <label>Concentration (M)ï¼š<input type="number" id="conc21"></label>
    <label>PR (%)ï¼š<input type="number" id="PR21"></label>

    <h3>ç¬¬äºŒæ¬¡æª¢é«”</h3>
    <label>Volume (ml)ï¼š<input type="number" id="volume22" step="0.1"></label>
    <label>Concentration (M)ï¼š<input type="number" id="conc22"></label>
    <label>PR (%)ï¼š<input type="number" id="PR22"></label>

    <label>å†·å‡ç®¡æ•¸ï¼š<input type="number" id="tubes2"></label>

    <button onclick="generateDoctor2B()">âš™ï¸ç”¢ç”Ÿé†«å¸«è¨Šæ¯</button>
    <button onclick="generatePatient2B()">âš™ï¸ç”¢ç”Ÿå€‹æ¡ˆè¨Šæ¯</button>
  </div>

  <button onclick="copyMessage()">âœ…è¤‡è£½è¨Šæ¯</button>

  <div id="output"></div>

  <script>
    document.getElementById("doctor").addEventListener("change", function() {
      let custom = document.getElementById("doctorCustom");
      custom.style.display = (this.value === "è‡ªå¡«") ? "block" : "none";
    });

    function switchScenario() {
      document.getElementById("scenario1").style.display = "none";
      document.getElementById("scenario2b").style.display = "none";
      let s = document.getElementById("scenario").value;
      if (s === "s1") document.getElementById("scenario1").style.display = "block";
      if (s === "s2b") document.getElementById("scenario2b").style.display = "block";
    }

    // === æƒ…å¢ƒ 1 ===
    function generateDoctor1() {
      let caseId = document.getElementById("caseId").value.trim();
      let caseName = document.getElementById("caseName").value.trim();
      let doctor = document.getElementById("doctor").value;
      if (doctor === "è‡ªå¡«") doctor = document.getElementById("doctorCustom").value;

      let volume = parseFloat(document.getElementById("volume1").value);
      let conc = parseFloat(document.getElementById("conc1").value);
      let PR = parseFloat(document.getElementById("PR1").value);
      let tubes = document.getElementById("tubes1").value.trim();

      let abnormalities = [];
      if (volume < 1) abnormalities.push(`Volume: ${volume} ml`);
      if (conc < 15) abnormalities.push(`Concentration: ${conc} M`);
      if (PR < 30) abnormalities.push(`PR: ${PR}%`);

      if (abnormalities.length === 0) {
        document.getElementById("output").innerText = "ï¼ˆæ•¸æ“šç„¡ç•°å¸¸ï¼Œä¸éœ€å‚³è¨Šæ¯ï¼‰";
        return;
      }

      let message = `${doctor}æ‚¨å¥½ï¼Œ\n
ä»Šæ—¥å‡ç²¾å€‹æ¡ˆ #${caseId} ${caseName}
æª¢é«”åˆ†æï¼š\n
${abnormalities.join("\n")}
ç”±æ–¼å€‹æ¡ˆä»Šæ—¥ç„¡æ³•ç•™åœ¨ç¾å ´ç­‰å€™ï¼Œå¯¦é©—å®¤å·²å…ˆå°‡æ­¤æ¬¡ç²¾èŸ²å†·å‡ ${tubes} ç®¡ï¼Œ\n
å»ºè­°å€‹æ¡ˆå¯ä»¥æ“‡æ—¥å†å†·å‡ï¼Œæˆ–è€…æ–¼å—ç²¾ç™‚ç¨‹ç•¶å¤©ä½¿ç”¨æ–°é®®ç²¾èŸ²å—ç²¾ã€‚\n`;

      document.getElementById("output").innerText = message;
    }

    function generatePatient1() {
      let caseName = document.getElementById("caseName").value.trim();
      let tubes = document.getElementById("tubes1").value.trim();

      let abnormalities = [];
      let volume = parseFloat(document.getElementById("volume1").value);
      let conc = parseFloat(document.getElementById("conc1").value);
      let PR = parseFloat(document.getElementById("PR1").value);

      if (volume < 1) abnormalities.push("é«”ç©ä¸è¶³");
      if (conc < 15) abnormalities.push("æ¿ƒåº¦åä½");
      if (PR < 30) abnormalities.push("æ´»å‹•åŠ›ä¸è¶³");

      let abnText = abnormalities.length > 0 ? `ï¼ˆ${abnormalities.join("ã€")}ï¼‰` : "";

      let message = `${caseName}æ‚¨å¥½ï¼Œ\n
ä»Šæ—¥æª¢é«”ç²¾èŸ²ç‹€æ³è¼ƒä¸ç†æƒ³${abnText}ã€‚\n
æˆ‘å€‘å·²å…ˆå°‡æ­¤æ¬¡ç²¾èŸ²å†·å‡ ${tubes} ç®¡ï¼Œ\n
å»ºè­°æ‚¨å¯æ“‡æ—¥å®‰æ’å†æ¬¡å‡ç²¾ï¼Œæˆ–æ–¼å—ç²¾ç™‚ç¨‹ç•¶å¤©æä¾›æ–°é®®ç²¾æ¶²ã€‚\n
æ­¤æ¬¡å‡ç²¾çš„æª¢é©—å ±å‘Šå·²ä¸Šå‚³è‡³ APPï¼Œè‹¥æœ‰ç–‘å•ä¹Ÿå»ºè­°æ‚¨å›è¨ºèˆ‡é†«å¸«è«®è©¢ã€‚\n
è¬è¬æ‚¨ã€‚`;

      document.getElementById("output").innerText = message;
    }

    // === æƒ…å¢ƒ 2B ===
    function generateDoctor2B() {
      let caseId = document.getElementById("caseId").value.trim();
      let caseName = document.getElementById("caseName").value.trim();
      let doctor = document.getElementById("doctor").value;
      if (doctor === "è‡ªå¡«") doctor = document.getElementById("doctorCustom").value;

      let v1 = document.getElementById("volume21").value.trim();
      let c1 = document.getElementById("conc21").value.trim();
      let p1 = document.getElementById("PR21").value.trim();

      let v2 = document.getElementById("volume22").value.trim();
      let c2 = document.getElementById("conc22").value.trim();
      let p2 = document.getElementById("PR22").value.trim();

      let tubes = document.getElementById("tubes2").value.trim();

      let message = `${doctor}æ‚¨å¥½ï¼Œ\n
ä»Šæ—¥å‡ç²¾å€‹æ¡ˆ #${caseId} ${caseName}
æª¢é«”åˆ†æï¼š\n
ç¬¬ä¸€æ¬¡ï¼š\n  Volume: ${v1} ml\n  Concentration: ${c1} M\n  PR: ${p1}%\n
ç¬¬äºŒæ¬¡ï¼š\n  Volume: ${v2} ml\n  Concentration: ${c2} M\n  PR: ${p2}%\n
äºŒæ¬¡ç¹³äº¤å¾Œç²¾èŸ²ç‹€æ³ä»ä¸ä½³ï¼Œ\n
å¯¦é©—å®¤å·²å…ˆå°‡æ­¤æ¬¡ç²¾èŸ²å†·å‡ ${tubes} ç®¡å‚™ç”¨ï¼Œ\n
å»ºè­°å¯è«‹å€‹æ¡ˆæ“‡æ—¥å®‰æ’å†æ¬¡å‡ç²¾ï¼Œæˆ–æ–¼å—ç²¾ç™‚ç¨‹ç•¶å¤©ä½¿ç”¨æ–°é®®ç²¾èŸ²ã€‚`;

      document.getElementById("output").innerText = message;
    }

    function generatePatient2B() {
      let caseName = document.getElementById("caseName").value.trim();
      let tubes = document.getElementById("tubes2").value.trim();

      let abn = [];
      let c2 = parseFloat(document.getElementById("conc22").value);
      let p2 = parseFloat(document.getElementById("PR22").value);

      if (c2 < 15) abn.push("æ¿ƒåº¦åä½");
      if (p2 < 30) abn.push("æ´»å‹•åŠ›ä¸è¶³");

      let abnText = abn.length > 0 ? `ï¼ˆ${abn.join("ã€")}ï¼‰` : "";

      let message = `${caseName}æ‚¨å¥½ï¼Œ\n
ä»Šæ—¥æ‚¨æ–¼æœ¬é™¢ç¹³äº¤ 2 æ¬¡æª¢é«”ï¼Œç²¾èŸ²ç‹€æ³ä»ä¸ç†æƒ³${abnText}ã€‚\n
æˆ‘å€‘å·²å…ˆå°‡æ­¤æ¬¡ç²¾èŸ²å†·å‡ ${tubes} ç®¡å‚™ç”¨ï¼Œ\n
å»ºè­°æ‚¨å¯æ“‡æ—¥å®‰æ’å†æ¬¡å‡ç²¾ï¼Œæˆ–æ–¼å—ç²¾ç™‚ç¨‹ç•¶å¤©æä¾›æ–°é®®ç²¾æ¶²ã€‚\n
æ­¤æ¬¡æª¢é©—å ±å‘Šå·²ä¸Šå‚³è‡³ APPï¼Œè‹¥æœ‰ç–‘å•ä¹Ÿå»ºè­°æ‚¨å›è¨ºèˆ‡é†«å¸«è«®è©¢ã€‚\n
è¬è¬æ‚¨ã€‚`;

      document.getElementById("output").innerText = message;
    }

    // === è¤‡è£½ ===
    function copyMessage() {
      let text = document.getElementById("output").innerText;
      if (!text || text.includes("ä¸éœ€å‚³è¨Šæ¯")) {
        alert("ç›®å‰æ²’æœ‰éœ€è¦è¤‡è£½çš„è¨Šæ¯");
        return;
      }
      navigator.clipboard.writeText(text).then(() => {
        alert("è¨Šæ¯å·²è¤‡è£½");
      });
    }
  </script>
</body>
</html>
